<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="node_modules/spectre.css/dist/spectre.min.css">
	<link rel="stylesheet" href="node_modules/spectre.css/dist/spectre-exp.min.css">
	<link rel="stylesheet" href="node_modules/spectre.css/dist/spectre-icons.min.css">
	<link rel="stylesheet" href="assets/style.css">
	<title>Detail product</title>
</head>

<body>
	<script>

		(async () => {
			const root = document.querySelector('body');

			const id_nft = 385541148;

			function createElement(tag, config, parent = null) {

				const { text, color, myclass, imgsrc, myid } = config || {};

				const element = document.createElement(tag);

				if (color) {
					element.style.color = color;
				}

				if (text) {
					element.innerHTML = text;
				}
				if (myclass) {
					if (Array.isArray(myclass)) {
						element.classList.add(...myclass);
					} else {
						element.classList.add(myclass);
					}
				}
				if (imgsrc) {
					element.src = imgsrc;
				}
				if (myid) {
					element.id = myid;
				}
				if (!parent) {
					root.appendChild(element);
				} else {
					parent.appendChild(element);
				}
				return element;
			}

			async function dataFetchingSingle(url) {
				const raw = await fetch(url);
				return await raw.json();
			}

			async function dataFetching(url) {
				const raw = await fetch(url);
				const { assets } = await raw.json();
				return assets;
			}
			//création des divs
					createElement('div', { myid: 'navigation', myclass: 'navigation' }, root);
					createElement('div', { myid: 'product_detail', myclass: 'container' }, root);
					createElement('div', { myid: 'product_essential', myclass: 'product_essential' }, root);
					createElement('div', { myid: 'product_information', myclass: 'product_information' }, root);
					createElement('div', { myid: 'product_information_left', myclass: 'product_information_child' }, root);
					createElement('div', { myid: 'product_information_right', myclass: ['product_information_child', 'bg_grey'] }, root);

			try {

				const asset = await dataFetchingSingle(`https://awesome-nft-app.herokuapp.com/nft/${id_nft}`)
				console.log(asset);
				const { name, description, image_url, collection, creator } = asset;

				// Navigation : bouton retour
				createElement('p', { text: 'ici le bouton retour', color: '', myclass: 'text-center' }, navigation);
				//createElement('button', { text: "Voir la fiche détails", myonclick: `index.html`, myclass: 'button' }, div);

				const divProductDetail = document.getElementById('product_detail');
				const divProductEssential = document.getElementById('product_essential');
				divProductDetail.append(divProductEssential);

				// Div Product Essential

				createElement('h1', { text: 'Fiche produit', color: '', myclass: 'text-center' }, divProductEssential);
				createElement('hr', { text: '', color: '', myclass: ['text-center', 'hr-horizontal', 'center', 'w-60'] }, divProductEssential);
				createElement('h2', { text: name, color: '', myclass: 'text-center' }, divProductEssential);
				createElement('hr', { text: '', color: '', myclass: ['text-center', 'hr-horizontal', 'center', 'w-60'] }, divProductEssential);

				if (image_url) {
					createElement('img', { imgsrc: image_url, myclass: ['img-responsive', 'img-product'] }, divProductEssential);
				}

				// Div Information : coontient 2 div
				// Div Child Information Left : Informations concernant le produit


				const divProductInformation = document.getElementById('product_information');
				divProductDetail.append(divProductInformation);

				const divProductInformationLeft = document.getElementById('product_information_left');
				divProductInformation.append(divProductInformationLeft);
				// Description
				if (description) {
					createElement('h3', { text: 'Description :', color: '', myclass: '' }, divProductInformationLeft);
					createElement('hr', { text: '', color: '', myclass: ['ml-0', 'hr-horizontal', 'w-100'] }, divProductInformationLeft);
					createElement('p', { text: description, color: 'black', myclass: '' }, divProductInformationLeft);
				}
				// Créateur
				if (creator.username) {
					createElement('p', { text: creator.username, color: 'black', myclass: 'creator' }, divProductInformationLeft);
				}

				// Div Child Information Right : informations concernant la collection
				const divProductInformationRight = document.getElementById('product_information_right');
				divProductInformation.append(divProductInformationRight);

				createElement('h3', { text: 'Collection :', color: '', myclass: '' }, divProductInformationRight);
				createElement('hr', { text: '', color: '', myclass: ['ml-0', 'hr-horizontal', 'w-100'] }, divProductInformationRight);
				// Nom de la collection
				if (collection.name) {
					createElement('p', { text: collection.name, color: 'black', myclass: '' }, divProductInformationRight);
				}
				// Image de la collection
				if (collection.banner_image_url) {
					createElement('img', { imgsrc: collection.banner_image_url, myclass: ['img-responsive', 'test'] }, divProductInformationRight);
				}
				// Date de création
				if (collection.created_at) {
					createElement('p', { text: collection.created_at, color: 'black', myclass: 'date' }, divProductInformationRight);
				}

			} catch (error) {
				console.log(error);
			}
		})();

	</script>
</body>


</html>
